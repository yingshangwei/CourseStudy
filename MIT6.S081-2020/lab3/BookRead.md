## Chapter 3

- TLB是CPU缓存pagetable的一个容器。（TODO::每个CPU一个还是说和寄存器一样每个进程一份？）。

  修改pagetable后一定要去清空TLB或者说刷新。

- xv6的内存分配器（感觉可以视为page分配器，毕竟一申请空间就直接按page分配了）使用链表管理所有空闲的page空间，然后每个链表的结点都存在对应的page空间上，很有意思的设计。

  （TODO::看到链表的头节点是直接定义在分配函数文件中，所以是不是可以理解为，对于真实的系统，其头节点存在kernel虚拟地址的用户空间中？）

- 从书中可以理解，一般操作系统对于大内存的分配，是按页来的，注意对于按页分配的内存，最终分配的空间是按页大小对齐的。

  思忖一下，更加优良的设计估计是可以将非对齐部分割裂管理。不过对于上层来说，肯定是先按页对齐分配。

- 对于每一个进程，在kernel的虚拟内存中都会有一个对应的kstack（用来执行kernel态的代码），注意在连续kstack最后会有个无效页用来处理kstack访问的溢出问题，报错或者是继续分配空间....

- 这里对exec系统调用的描述印证了自己之前在看《程序员的自我修养》一书中对于elf文件的理解，elf文件本质上就是一个程序用户空间部分的内存印象，加上了一些如何布局的其他描述等。主要还是要理解elf文件的本质...